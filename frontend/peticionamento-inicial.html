<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Peticionamento Inicial - MNI Web App</title>
    <link rel="stylesheet" href="css/peticionamento-inicial.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üìù Peticionamento Inicial</h1>
            <p class="subtitle">Criar novo processo judicial via MNI 3.0 (Modelo Nacional de Interoperabilidade)</p>
            <a href="index.html" class="btn btn-secondary">‚Üê Voltar ao Dashboard</a>
        </header>

        <div class="info-box" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
            <p style="margin: 0 0 10px 0;"><strong>üÜï ATUALIZA√á√ÉO: Agora usando MNI 3.0!</strong></p>
            <p style="margin: 0; font-size: 14px; opacity: 0.95;">
                Este formul√°rio foi migrado para o <strong>MNI 3.0</strong>, que oferece sele√ß√£o em cascata (localidade ‚Üí compet√™ncia ‚Üí classe ‚Üí assunto).
                Isso garante que apenas op√ß√µes <strong>v√°lidas</strong> sejam exibidas, eliminando erros de "classe complementar" ou "assunto inv√°lido".
                O sistema MNI 2.2 continua dispon√≠vel para peticionamento intermedi√°rio.
            </p>
        </div>

        <div class="info-box">
            <p><strong>‚ÑπÔ∏è Importante:</strong> Preencha todos os campos obrigat√≥rios marcados com asterisco (*). O peticionamento inicial cria um novo processo no sistema judicial.</p>
        </div>

        <main>
            <form id="formPeticionamentoInicial" class="form-card">

                <!-- CPF do Signat√°rio (Novo - Primeiro Campo) -->
                <fieldset>
                    <legend>‚úçÔ∏è Signat√°rio</legend>

                    <div class="info-box">
                        <p>‚ÑπÔ∏è <strong>CPF do Signat√°rio:</strong> O CPF preenchido abaixo ser√° registrado no processo como o representante da parte peticionante e como respons√°vel pelo evento no e-Proc. Caso seja deixado em branco, a parte n√£o ter√° representante e o evento ter√° o nome do usu√°rio WS.</p>
                    </div>

                    <div class="form-group">
                        <label for="signatario" class="required">CPF do Signat√°rio</label>
                        <input type="text" id="signatario" required placeholder="Ex: 12345678901" autocomplete="off">
                        <small>‚úçÔ∏è CPF de quem assina a peti√ß√£o (campo obrigat√≥rio)</small>
                    </div>
                </fieldset>

                <!-- Dados do Processo -->
                <fieldset>
                    <legend>‚öñÔ∏è Dados do Processo (MNI 3.0 - Sele√ß√£o em Cascata)</legend>

                    <div class="info-box" style="background: #f0f8ff; border-left: 4px solid #667eea; padding: 12px; margin-bottom: 20px;">
                        <p style="margin: 0; font-size: 13px;">
                            <strong>üí° Como funciona:</strong> Selecione os campos em ordem. Cada sele√ß√£o filtra as op√ß√µes seguintes,
                            garantindo que apenas op√ß√µes <strong>v√°lidas</strong> sejam exibidas.
                        </p>
                    </div>

                    <!-- PASSO 1: Localidade -->
                    <div class="form-group">
                        <label for="localidade" class="required">
                            <span style="background: #667eea; color: white; padding: 2px 8px; border-radius: 12px; font-size: 11px; margin-right: 5px;">PASSO 1</span>
                            Comarca/Localidade Judicial
                        </label>
                        <select id="localidade" required>
                            <option value="">üîÑ Carregando localidades...</option>
                        </select>
                        <small>Selecione a comarca onde o processo ser√° distribu√≠do</small>
                    </div>

                    <!-- PASSO 2: Compet√™ncia -->
                    <div class="form-group">
                        <label for="competencia">
                            <span style="background: #764ba2; color: white; padding: 2px 8px; border-radius: 12px; font-size: 11px; margin-right: 5px;">PASSO 2</span>
                            Compet√™ncia Judicial
                        </label>
                        <select id="competencia" disabled>
                            <option value="">üìç Selecione uma localidade primeiro</option>
                        </select>
                        <small>Compet√™ncias dispon√≠veis para a localidade selecionada (opcional)</small>
                    </div>

                    <!-- PASSO 3: Classe -->
                    <div class="form-group">
                        <label for="classe" class="required">
                            <span style="background: #667eea; color: white; padding: 2px 8px; border-radius: 12px; font-size: 11px; margin-right: 5px;">PASSO 3</span>
                            Classe Processual
                        </label>
                        <select id="classe" required disabled>
                            <option value="">üìç Selecione uma localidade primeiro</option>
                        </select>
                        <small>Classes v√°lidas para o contexto selecionado (Ex: Execu√ß√£o Fiscal, Procedimento Comum)</small>
                    </div>

                    <!-- PASSO 4: Assunto -->
                    <div class="form-group">
                        <label for="assunto">
                            <span style="background: #764ba2; color: white; padding: 2px 8px; border-radius: 12px; font-size: 11px; margin-right: 5px;">PASSO 4</span>
                            Assunto Principal
                        </label>
                        <select id="assunto" disabled>
                            <option value="">üìç Selecione uma classe primeiro</option>
                        </select>
                        <small>Assuntos v√°lidos para a classe selecionada (opcional)</small>
                    </div>

                    <div class="form-grid">
                        <div class="form-group">
                            <label for="valorCausa">Valor da Causa (R$)</label>
                            <input type="number" id="valorCausa" step="0.01" min="0" placeholder="0.00">
                        </div>

                        <div class="form-group">
                            <label for="nivelSigilo">N√≠vel de Sigilo</label>
                            <select id="nivelSigilo">
                                <option value="0" selected>üåê P√∫blico (Padr√£o)</option>
                                <option value="1">üîí Segredo de Justi√ßa</option>
                                <option value="2">üîê Sigilo</option>
                            </select>
                        </div>
                    </div>
                </fieldset>

                <!-- Info sobre assuntos complementares -->
                <div class="info-box" style="background: #fff3cd; border-left: 4px solid #ffc107; padding: 12px; margin-bottom: 20px;">
                    <p style="margin: 0; font-size: 13px;">
                        <strong>üìå Assuntos Principal e Complementares:</strong>
                        O assunto selecionado acima ser√° o <strong>principal</strong>.
                        Se precisar adicionar assuntos complementares, isso poder√° ser feito ap√≥s a cria√ß√£o do processo.
                    </p>
                </div>

                <!-- Remover o campo de sigilo duplicado abaixo -->
                <fieldset style="display: none;">
                    <legend>Deprecated - Campo movido acima</legend>

                    <div class="form-group">
                        <label for="nivelSigilo">N√≠vel de Sigilo</label>
                        <select id="nivelSigilo">
                            <option value="0" selected>üåê P√∫blico (Padr√£o)</option>
                            <option value="1">üîí Segredo de Justi√ßa</option>
                            <option value="2">üîê Sigilo</option>
                        </select>
                    </div>
                </fieldset>

                <!-- Polo Ativo (Autores) -->
                <fieldset>
                    <legend>üë§ Polo Ativo (Autor/Autores)</legend>

                    <div id="poloAtivoContainer">
                        <div class="parte-item" data-polo="ativo">
                            <h4>Parte 1</h4>

                            <div class="form-group">
                                <label>Tipo de Pessoa:</label>
                                <select class="tipoPessoa" onchange="toggleTipoPessoa(this)">
                                    <option value="fisica">Pessoa F√≠sica</option>
                                    <option value="juridica">Pessoa Jur√≠dica</option>
                                </select>
                            </div>

                            <div class="campos-pf">
                                <div class="form-group">
                                    <label>Nome Completo:</label>
                                    <input type="text" class="nomeCompleto" placeholder="Ex: Jo√£o da Silva">
                                </div>

                                <div class="form-group">
                                    <label>CPF:</label>
                                    <input type="text" class="cpf" placeholder="Ex: 12345678901">
                                </div>

                                <div class="form-group">
                                    <label>Data de Nascimento:</label>
                                    <input type="text" class="dataNascimento" placeholder="DD/MM/AAAA">
                                </div>

                                <div class="form-group">
                                    <label>Sexo:</label>
                                    <select class="sexo">
                                        <option value="Masculino">Masculino</option>
                                        <option value="Feminino">Feminino</option>
                                    </select>
                                </div>
                            </div>

                            <div class="campos-pj" style="display: none;">
                                <div class="form-group">
                                    <label>Raz√£o Social:</label>
                                    <input type="text" class="razaoSocial" placeholder="Ex: Empresa LTDA">
                                </div>

                                <div class="form-group">
                                    <label>CNPJ:</label>
                                    <input type="text" class="cnpj" placeholder="Ex: 12345678000199">
                                </div>
                            </div>
                        </div>
                    </div>

                    <button type="button" class="btn btn-secondary" onclick="adicionarParte('ativo')">+ Adicionar Autor</button>
                </fieldset>

                <!-- Polo Passivo (R√©us) -->
                <fieldset>
                    <legend>üë• Polo Passivo (R√©u/R√©us)</legend>

                    <div id="poloPassivoContainer">
                        <div class="parte-item" data-polo="passivo">
                            <h4>Parte 1</h4>

                            <div class="form-group">
                                <label>Tipo de Pessoa:</label>
                                <select class="tipoPessoa" onchange="toggleTipoPessoa(this)">
                                    <option value="fisica">Pessoa F√≠sica</option>
                                    <option value="juridica">Pessoa Jur√≠dica</option>
                                </select>
                            </div>

                            <div class="campos-pf">
                                <div class="form-group">
                                    <label>Nome Completo:</label>
                                    <input type="text" class="nomeCompleto" placeholder="Ex: Maria Santos">
                                </div>

                                <div class="form-group">
                                    <label>CPF:</label>
                                    <input type="text" class="cpf" placeholder="Ex: 98765432100">
                                </div>

                                <div class="form-group">
                                    <label>Data de Nascimento:</label>
                                    <input type="text" class="dataNascimento" placeholder="DD/MM/AAAA">
                                </div>

                                <div class="form-group">
                                    <label>Sexo:</label>
                                    <select class="sexo">
                                        <option value="Masculino">Masculino</option>
                                        <option value="Feminino">Feminino</option>
                                    </select>
                                </div>
                            </div>

                            <div class="campos-pj" style="display: none;">
                                <div class="form-group">
                                    <label>Raz√£o Social:</label>
                                    <input type="text" class="razaoSocial" placeholder="Ex: Empresa XYZ LTDA">
                                </div>

                                <div class="form-group">
                                    <label>CNPJ:</label>
                                    <input type="text" class="cnpj" placeholder="Ex: 98765432000188">
                                </div>
                            </div>
                        </div>
                    </div>

                    <button type="button" class="btn btn-secondary" onclick="adicionarParte('passivo')">+ Adicionar R√©u</button>
                </fieldset>

                <!-- Documentos -->
                <fieldset>
                    <legend>üìé Documentos</legend>

                    <div class="warning-box">
                        <p>‚ö†Ô∏è <strong>Aten√ß√£o:</strong> Anexe apenas arquivos em formato PDF. Tamanho m√°ximo recomendado: 11MB por arquivo.</p>
                    </div>

                    <div class="form-group">
                        <label for="peticaoInicial" class="required">Peti√ß√£o Inicial (PDF)</label>
                        <input type="file" id="peticaoInicial" accept=".pdf" required>
                        <small>üìÑ Selecione o arquivo PDF contendo a peti√ß√£o inicial</small>
                    </div>

                    <div class="form-group">
                        <label for="documentosAdicionais">Documentos Adicionais</label>
                        <input type="file" id="documentosAdicionais" accept=".pdf" multiple>
                        <small>üìé Procura√ß√£o, documentos pessoais, etc. (Voc√™ pode selecionar m√∫ltiplos arquivos)</small>
                    </div>
                </fieldset>

                <!-- Bot√µes -->
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">
                        <span>üì®</span>
                        <span>Enviar Peti√ß√£o Inicial</span>
                    </button>
                    <button type="reset" class="btn btn-secondary">
                        <span>üîÑ</span>
                        <span>Limpar Formul√°rio</span>
                    </button>
                </div>
            </form>

            <!-- Resultado -->
            <div id="resultado" class="result-container" style="display: none;">
                <h3>Resultado</h3>
                <div id="resultadoConteudo"></div>
            </div>

            <!-- Debug SOAP XML -->
            <div id="soapDebug" class="soap-debug-container" style="display: none;">
                <div class="soap-debug-header">
                    <h3>üîç Debug SOAP - XML Completo</h3>
                    <button type="button" class="btn btn-secondary" onclick="toggleSoapDebug()">
                        <span id="toggleIcon">‚ñº</span> Expandir/Recolher
                    </button>
                </div>

                <div id="soapDebugContent" class="soap-debug-content" style="display: none;">
                    <div class="soap-section">
                        <h4>üì§ Requisi√ß√£o SOAP Enviada</h4>
                        <div class="soap-actions">
                            <button type="button" class="btn-copy" onclick="copiarXML('request')">üìã Copiar</button>
                            <button type="button" class="btn-download" onclick="baixarXML('request')">üíæ Baixar</button>
                        </div>
                        <pre id="soapRequest" class="xml-content"></pre>
                    </div>

                    <div class="soap-section">
                        <h4>üì• Resposta SOAP Recebida</h4>
                        <div class="soap-actions">
                            <button type="button" class="btn-copy" onclick="copiarXML('response')">üìã Copiar</button>
                            <button type="button" class="btn-download" onclick="baixarXML('response')">üíæ Baixar</button>
                        </div>
                        <pre id="soapResponse" class="xml-content"></pre>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="js/utils.js"></script>
    <script src="js/peticionamento-inicial.js"></script>
</body>
</html>
